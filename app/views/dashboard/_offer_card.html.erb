<div class="col-sm-6 col-lg-4">
  <div class="card" style="min-height: 400px; max-height: 400px;">
    <div class="card-body">
      <div class="d-flex align-items-center mb-3 border-bottom pb-3">
        <div>
          <h3 class="card-title mb-0">
            <%= truncate(offer.title, length: 40) %>
          </h3>

          <p class="text-muted mb-1">
            <%= truncate(offer.company_name, length: 40) %>
          </p>

          <%= badge_for(:verification_status, offer.verification_status) %>
          <%= badge_for(:status, offer.status) %>
        </div>

        <div class="dropdown ms-auto" data-controller="dashboard">
          <a
            href="#"
            class="btn btn-icon btn-ghost-secondary"
            data-bs-toggle="dropdown"
          >
            <i class="ti ti-dots-vertical"></i>
          </a>
          <div class="dropdown-menu">
            <p class="dropdown-header">Change Status</p>

            <% status_options.each do |label, status| %>
              <% if status == offer.status %>
                <p class="dropdown-item active"><%= label %></p>
              <% else %>
                <%= button_to label,
                offer_path(offer, offer: {status: status}, redirect_to: request.fullpath),
                method: :patch,
                class: "dropdown-item" %>
              <% end %>
            <% end %>

            <div class="dropdown-divider"></div>

            <p class="dropdown-header">Verification</p>

            <%= request_verification_button offer %>
          </div>
        </div>
      </div>

      <div class="col">
        <div class="d-flex row align-items-center mb-2">
          <div class="col-auto"><i class="ti ti-map-pin fs-2"></i></div>
          <div class="col ps-0">
            <div class="text-truncate"><%= offer.address || 'Remote' %></div>
          </div>
        </div>

        <div class="d-flex row align-items-center mb-2">
          <div class="col-auto"><i class="ti ti-briefcase fs-2"></i></div>
          <div class="col ps-0">
            <div class="text-truncate">
              <%= offer.job_type.humanize(capitalize: true) || 'Full-time' %>
            </div>
          </div>
        </div>

        <div class="d-flex row align-items-center mb-2">
          <div class="col-auto"><i class="ti ti-cash fs-2"></i></div>
          <div class="col ps-0">
            <div class="text-truncate">
              <%= offer.contract_type.humanize(capitalize: true) || 'Permanent' %>
            </div>
          </div>
        </div>
      </div>

      <div class="mt-3">
        <p class="text-wrap" style="max-height: 4rem; overflow: hidden;">
          <%= truncate(offer.description.to_plain_text, length: 300) %>
          <!-- TODO: Add blur gradient effect for overflow text -->
        </p>
      </div>
    </div>

    <div class="ms-3 bg-transparent pt-0 border-0 pb-3">
      <p class="text-muted"><small>Created: <%= offer.created_at %></small></p>
      <div class="d-flex gap-2">
        <%= link_to 'View', offer_path(offer), class: 'btn btn-primary' %>
        <%= link_to 'Edit', edit_offer_path(offer), class: 'btn' %>
        <%= button_to 'Delete', offer_path(offer), method: :delete, form: { data: { turbo_method: :delete, turbo_confirm: 'This action is cannot be undone', variant: :danger, title: "Are you sure you want to delete this offer ?"}}, class: 'btn btn-outline-danger' %>
      </div>
    </div>
  </div>
</div>
